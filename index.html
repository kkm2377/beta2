<!DOCTYPE html>
<html lang="jp" dir="ltr">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>liff-beta</title>
        <link rel="stylesheet" href="style.css">
        <script src="https://line-objects-internal.com/assets/liff/edge/2/sdk.js"></script>
        <script type="module" src="https://line-objects-internal.com/assets/lui/edge/versions/1.11.0/luivendor.js"></script>
        <script type="module" src="https://line-objects-internal.com/assets/lui/edge/versions/1.11.0/lui-navigation-back.js"></script>
        <script type="module" src="https://line-objects-internal.com/assets/lui/edge/versions/1.11.0/lui-navigation-bar.js"></script>
        <script type="text/javascript">
            /**
            * Initialize LIFF
            * @param {string} myLiffId The LIFF app ID of the selected element
            */
            document.addEventListener("DOMContentLoaded", () => {
                liff
                    .init({
                        liffId: "1651833066-zO3vlq60"
                    })
                    .then(() => {
                        document.getElementById('go').addEventListener('click', () => {
                            document.getElementById('log').value =
                              '○言語設定\n' +
                              'liff.getLanguage()=' + liff.getLanguage() + '\n' +
                              '○LIFF SDKのバージョン\n' +
                              'liff.getVersion()=' + liff.getVersion() + '\n' +
                              '○LIFF LINEのバージョン\n' +
                              'liff.getLineVersion()=' + liff.getLineVersion() + '\n' +
                              '○LINE内ブラウザで動作させているかどうか\n' +
                              'liff.isInClient()=' + liff.isInClient() + '\n' +
                              '○ログインしているかどうか\n' +
                              'liff.isLoggedIn()=' + liff.isLoggedIn() + '\n' +
                              '○OS\n' +
                              'liff.getOS()=' + liff.getOS() + '\n' +
                              '○アクセストークン\n' +
                              'liff.getAccessToken()=' + liff.getAccessToken() + '\n' +
                              '○Get ID Token\n' +
                              'liff.getIDToken()=' + liff.getIDToken() + '\n' +
                              '○画面（1対1のチャット、グループ、またはトークルーム）を一意に識別する値\n' +
                              'liff.getContext()=' + JSON.stringify(liff.getContext()) + '\n' +
                              '○ユーザー名等\n' +
                              'liff.getDecodedIDToken()=' + JSON.stringify(liff.getDecodedIDToken()) + '\n\n\n' +
                              '○ ユーザーのプロフィール\n' +
                              'liff.getProfile()=' + JSON.stringify(liff.getProfile()) + '\n' +
                              '○ Create URL\n' +
                              'liff.permanentLink.createUrl()=' + liff.permanentLink.createUrl() + '\n' ;
                        });
                        document.getElementById('popup').addEventListener('click', () => {
                            liff.openWindow({
                                url: "https://liff.line-beta.me/1655828362-KLxYgqxg",
                                external: true
                            });
                        });

                        document.getElementById('home').addEventListener('click', () => {
                            liff.addToHomeScreen({
                                name: "LINE",
                                iconUrl: "https://obs-beta.line-scdn.net/0hi2dU1wubNh1ZLCCnLGVJSntxPX9qTigWexgyezx-HU0oSQRLLjEmH3RQDVY_TwQ3LjUyJidHHkkyYAMgZiscAyB8DSw8dDc/f256x256",
                                state: "https://liff.line-beta.me/1651833066-0omDANP2"
                            });
                        });

                        document.getElementById('pic').addEventListener('click', () => {
                            var videoDom = document.getElementById('video');
                            var constraints = window.constraints = {
                                audio: false,
                                video: true
                            };
                            navigator.mediaDevices.getUserMedia(constraints)
                                .then(function(stream) {
                                console.log("got video stream");
                                videoDom.srcObject = stream;
                                videoDom.play();
                            })
                                .catch(function(error) {
                                console.error("error: ", error);
                            });
                        });
                    
                        document.getElementById('qrcode').addEventListener('click', () => {
                            if (liff.scanCode) {
                                liff.scanCode().then(result => {
                                    result = { value: '' }
                                });
                            }
                        });

                        document.getElementById('flex').addEventListener('click', () => {
                            liff.sendMessages([{
                                "type": "flex",
                                "altText": "This is a Flex Message",
                                "contents":
                            {
                                "type": "bubble",
                                "header": {
                                  "type": "box",
                                  "layout": "vertical",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "LINE Corp",
                                      "color": "#FFFFFF",
                                      "weight": "bold"
                                    }
                                  ]
                                },
                                "hero": {
                                  "type": "image",
                                  "url": "https://obs-beta.line-scdn.net/0hi2dU1wubNh1ZLCCnLGVJSntxPX9qTigWexgyezx-HU0oSQRLLjEmH3RQDVY_TwQ3LjUyJidHHkkyYAMgZiscAyB8DSw8dDc/f256x256",
                                  "size": "xl"
                                },
                                "body": {
                                  "type": "box",
                                  "layout": "vertical",
                                  "contents": [
                                    {
                                      "type": "text",
                                      "text": "hogehoge",
                                      "size": "xl",
                                      "weight": "bold",
                                      "align": "center"
                                    },
                                    {
                                      "type": "text",
                                      "text": "LINE Corp Developer",
                                      "align": "center"
                                    },
                                    {
                                      "type": "separator",
                                      "margin": "md"
                                    },
                                    {
                                      "type": "box",
                                      "layout": "vertical",
                                      "contents": [
                                        {
                                          "type": "button",
                                          "action": {
                                            "type": "uri",
                                            "label": "LINE Corp Official Site",
                                            "uri": "http://linecorp.com/"
                                          },
                                          "style": "link"
                                        },
                                        {
                                          "type": "button",
                                          "action": {
                                            "type": "uri",
                                            "label": "Sign in as a User",
                                            "uri": "https://android-liff-test.herokuapp.com/index.html"
                                          },
                                          "style": "link"
                                        },
                                        {
                                          "type": "button",
                                          "action": {
                                            "type": "uri",
                                            "label": "Ask me on the Call",
                                            "uri": "https://line.me/R/call/81/08012345678"
                                          },
                                          "style": "link"
                                        }
                                      ],
                                      "paddingTop": "10px"
                                    }
                                  ]
                                },
                                "styles": {
                                  "header": {
                                    "backgroundColor": "#00B900"
                                  }
                                }
                            }
                              }]);
                        });
                    })
                    .catch((err) => {
                        document.getElementById("liffAppContent").classList.add('hidden');
                        document.getElementById("liffInitErrorMessage").classList.remove('hidden');
                        console.log(err.code, err.message);
                    })
            })
        </script>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
        body {
            padding-left: /* safe-area-inset-left */ ;
            padding-right: /* safe-area-inset-right */ ;
            }
        const setNodeText = (selector, text) => {
            document.querySelector(selector).textContent = text;
        };
        
        const handleButtonClicked = e => {
        console.log(e);
        setNodeText('#log', 'button clicked');
        };
        
        const manualNavigate = () => {
        document.querySelector('lui-navigation-back').navigateBack();
        };
    </head>
    <body>
        <div class="content light-background-container">
            <lui-navigation-bar-spacer></lui-navigation-bar-spacer>
            <lui-navigation-bar menu-style="darkTranslucent">
                <lui-navigation-back slot="left"></lui-navigation-back>
                <h1 slot="center">very long titleeeeeeeeeeeeee</h1>
            </lui-navigation-bar>
            <div class="content" style="padding: 10px 20px; color: white;">
                <lui-navigation-back
                                     disable-auto-navigation
                                     @lui-button-click=${handleButtonClicked}
                                     ></lui-navigation-back>
                <div id="log"></div>
                <button @click=${() => manualNavigate()}>manualNavigation</button>
                <p>
                    ${generateDummyText()}
                </p>
                <h2>HTML Forms to https://httpbin.org/post with no parameter</h2>
                <form action="https://httpbin.org/post" method="post">
                    <input type="submit" value="Submit">
                </form>
                <h3>環境やトークルームの情報を取得222</h3>
                <input type="button" id="home" value="home"/>
                <input type="button" id="go" value="実行"/>
                <input type="button" id="popup" value="popup"/>
                <input type="button" id="pic" value="pic"/>
                <input type="button" id="flex" value="flex"/>
                <input type="button" id="qrcode" value="QRcode"/>
                
                <video id="video" autoplay style="width: 500px; height: 500px;">Video stream not available.</video>
                <a href="https://android-liff-test.herokuapp.com/index.html" target="_blank">IAB</a>
                <textarea id="log" style="width:96%;height:350px;"></textarea>
            </div>
        </div>
    </body>
</html>
